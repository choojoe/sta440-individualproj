---
title: "Individual"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(dplyr)
library(stringr)
library(anytime)
```

```{r}
raw <- read.csv("raw_yelp_review_data.csv")
```

```{r}

```


```{r}
raw <- raw %>%
  mutate(rating = as.numeric(substr(raw$star_rating, 1, 2)),
         rating.level = case_when(rating == 5 ~ "Positive",
                                  rating == 4 ~ "Neutral",
                                  rating <= 3 ~ "Bad"),
         length = nchar(as.character(raw$full_review_text)),
         num.exclamations = str_count(raw$full_review_text, "!"),
         num.questions = str_count(raw$full_review_text, "\\?")
         )

data <- raw
```

```{r}
library("tm")
library("SnowballC")
library("wordcloud")
library("RColorBrewer")
library("syuzhet")
library("ggplot2")
```

```{r}
data$full_review_text <- as.character(data$full_review_text)
text <- data$full_review_text
text <- tolower(text)
text <- removeNumbers(text)
text <- removePunctuation(text)
text <- removeWords(text, stopwords("english"))
text <- stripWhitespace(text)
text <- stemDocument(text)
data$full_review_text <- text

get_nrc_sentiment(text)[0]

```
data$full_review_text <- tm_map(data$full_review_text, content_transformer(tolower))
# Remove numbers
TextDoc <- tm_map(data, removeNumbers)
# Remove english common stopwords
TextDoc <- tm_map(data, removeWords, stopwords("english"))
# Remove your own stop word
# specify your custom stopwords as a character vector
TextDoc <- tm_map(data, removeWords, c("s", "company", "team")) 
# Remove punctuations
TextDoc <- tm_map(data, removePunctuation)
# Eliminate extra white spaces
TextDoc <- tm_map(data, stripWhitespace)
# Text stemming - which reduces words to their root form
TextDoc <- tm_map(data, stemDocument)

```


```{r}
raw %>%
  group_by(coffee_shop_name) %>%
  summarise(avg_score = mean(rating),
            sd = sd(rating),
            gap = (max(rating) - min(rating)),
            avg_length = mean(length),
            num = n()) %>%
  arrange(desc(avg_score))
```

```{r}

```



